# 🍏트랜잭션

---

## 트랜잭션

> 데이터베이스의 상태를 변화시키기 위해 수행하는 작업의 논리적인 단위. 
작업의 완전성을 보장.
논리적인 작업 셋을 완벽하게 처리하거나, 처리하지 못할 경우 원 상태로 복구해서 작업의 일부만 적용되는 현상이 발생하지 않게 만들어 주는 기능.
논리적인 작업 셋이 100% 적용되거나 아무것도 적용되지 않아야함을 보장.
> 

| 트랜잭션 | 잠금 |
| --- | --- |
| 데이터 정합성 보장 | 데이터 동시성 제어 |

### 특징

- `원자성 (Atomicity)` : 트랜잭션이 DB에 모두 반영되던가, 아니면 전혀 반영되지 않아야 한다는 것.
- `일관성 (Consistency)` : 트랜잭션의 작업 처리 결과가 항상 일관성이 있어야 한다는 것. 트랙잭션이 진행되는 동안에 데이터베이스가 변경되더라도, 업데이트된 데이터베이스로 트랜잭션을 진행하는 것이 아니라 처음에 트랜잭션을 진행하기 위해 참조한 데이터베이스로 진행.
- `독립성 (Isolation)` : 어떤 하나의 트랜잭션이라도, 다른 트랜잭션의 연산에 끼어들 수 없다는 것.
- `지속성 (Durability)` : 트랜잭션이 성공적으로 완료되었을 경우, 결과는 영구적으로 반영되어야 한다는 것.

### 트랜잭션 상태

![스크린샷 2025-11-12 13.13.07.png](./images/스크린샷%202025-11-12%2013.13.07.png)

1. **`활성`** 
    1. 트랜잭션이 정상적으로 실행중인 상태.
    2. 트랜잭션 시작 시, 해당 트랜잭션의 상태는 활동 상태.
2. **`부분 완료`**
    1. 트랜잭션의 마지막까지 실행되었지만, COMMIT 연산이 실행되기 직전의 상태.
    2. 트랜잭션 명령을 성공적으로 수행 → 부분적 완료 상태
    3. 성공적인 작업이었더라도 무조건 반영이 아니라 설계자의 최종 승인(COMMIT)이 있을 때까지 데이터베이스에 작업 내용을 반영하지 않고 기다리는 상태.
3. **`완료`**
    1. 트랜잭션이 성공으로 종료되어 COMMIT 연산을 실행한 후 상태
4. **`실패`**
    1. 트랜잭션 실행에 오류가 발생하여 중단된 상태
5. **`철회`**
    1. 트랜잭션이 비정상적으로 종료되어 ROLLBACK 연산을 수행한 상태

### Commit

- 하나의 트랜잭션이 성공적으로 완료되었고, 데이터베이스가 일관성있는 상태에 있을 때, 하나의 트랙잭션이 끝났다는 것을 알려주기 위해 사용하는 연산.
- **Commit** 수행 시 하나의 트랜잭션 종료.

### Rollback

- 하나의 트랜잭션 처리가 비정상적으로 종료되어 트랜잭션의 원자성이 꺠진 경우, 트랜잭션을 처음부터 시작하거나, 트랜잭션의 부분적으로만 연산된 결과를 다시 취소.
- 마지막 **Commit**을 완료한 시점으로 원복.
- 단, **DDL(CREATE, DROP, ALTER, RENAME, TRUNCATE)는** Rollback 대상❌


### Commit

- 하나의 트랜잭션이 성공적으로 완료되었고, 데이터베이스가 일관성있는 상태에 있을 때, 하나의 트랙잭션이 끝났다는 것을 알려주기 위해 사용하는 연산.

### Rollback

- 하나의 트랜잭션 처리가 비정상적으로 종료되어 트랜잭션의 원자성이 꺠진 경우, 트랜잭션을 처음부터 시작하거나, 트랜잭션의 부분적으로만 연산된 결과를 다시 취소.